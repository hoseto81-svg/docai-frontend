<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DocAI - Document Processing</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- PDF libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.js"></script>
    <!-- Excel library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        .uploading { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">

        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-5xl font-bold text-gray-800 mb-2">DocAI</h1>
            <p class="text-xl text-gray-600">AI-Powered Document Processing</p>
        </div>

        <!-- Upload Section -->
        <div id="uploadSection" class="max-w-2xl mx-auto">
            <div class="bg-white rounded-2xl shadow-xl p-8">
                <div class="border-4 border-dashed border-gray-300 rounded-xl p-12 text-center hover:border-blue-500 transition-colors cursor-pointer" id="dropZone">
                    <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    <p class="text-xl text-gray-700 mb-2">Drag & Drop —Ñ–∞–∫—Ç—É—Ä–∞ —Ç—É–∫</p>
                    <p class="text-gray-500 mb-4">–∏–ª–∏</p>
                    <label for="fileInput" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 cursor-pointer inline-block transition-colors">
                        –ò–∑–±–µ—Ä–∏ —Ñ–∞–π–ª
                    </label>
                    <input type="file" id="fileInput" class="hidden" accept=".pdf,.jpg,.jpeg,.png">
                    <p class="text-sm text-gray-500 mt-4">Supported: PDF, JPG, PNG ‚Ä¢ Max: 10MB</p>
                </div>

                <div id="selectedFile" class="mt-4 hidden">
                    <p class="text-gray-700">–ò–∑–±—Ä–∞–Ω —Ñ–∞–π–ª: <span id="fileName" class="font-semibold"></span></p>
                    <button id="uploadBtn" class="w-full mt-4 bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors text-lg font-semibold">
                        üöÄ –û–±—Ä–∞–±–æ—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
                    </button>
                </div>
            </div>
        </div>

        <!-- Processing Section -->
        <div id="processingSection" class="max-w-2xl mx-auto hidden">
            <div class="bg-white rounded-2xl shadow-xl p-8 text-center">
                <div class="uploading">
                    <svg class="mx-auto h-16 w-16 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                </div>
                <p class="text-xl text-gray-700 mt-4">–û–±—Ä–∞–±–æ—Ç–≤–∞ —Å–µ –¥–æ–∫—É–º–µ–Ω—Ç...</p>
                <p class="text-gray-500 mt-2">–¢–æ–≤–∞ –º–æ–∂–µ –¥–∞ –æ—Ç–Ω–µ–º–µ 10-15 —Å–µ–∫—É–Ω–¥–∏</p>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="max-w-4xl mx-auto hidden">
            <div class="bg-white rounded-2xl shadow-xl p-8">

                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-3xl font-bold text-green-600">‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–µ–Ω</h2>

                    <div class="flex gap-2">
                        <button id="exportPdfBtn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                            üìÑ –ò–∑—Ç–µ–≥–ª–∏ PDF
                        </button>
                        <button id="exportExcelBtn" class="bg-green-700 text-white px-4 py-2 rounded-lg hover:bg-green-800">
                            üìä –ò–∑—Ç–µ–≥–ª–∏ Excel
                        </button>
                        <button id="newDocBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                            –ù–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç
                        </button>
                    </div>
                </div>

                <div id="resultsContent" class="space-y-4"></div>

                <div class="mt-6 flex gap-4">
                    <button id="downloadJsonBtn" class="flex-1 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
                        üì• Download JSON
                    </button>
                    <button id="copyDataBtn" class="flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700">
                        üìã Copy Data
                    </button>
                </div>
            </div>
        </div>

        <!-- Error Section -->
        <div id="errorSection" class="max-w-2xl mx-auto hidden">
            <div class="bg-red-50 border-2 border-red-200 rounded-2xl shadow-xl p-8">
                <h2 class="text-2xl font-bold text-red-600 mb-4">‚ùå –ì—Ä–µ—à–∫–∞</h2>
                <p id="errorMessage" class="text-gray-700"></p>
                <button id="retryBtn" class="mt-4 bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700">
                    –û–ø–∏—Ç–∞–π –æ—Ç–Ω–æ–≤–æ
                </button>
            </div>
        </div>

    </div>
    <script>
    const API_URL = "https://docai.hoseto.cloud";

    let selectedFile = null;
    let resultsData = null;

    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('fileInput');
    const selectedFileDiv = document.getElementById('selectedFile');
    const fileNameSpan = document.getElementById('fileName');
    const uploadBtn = document.getElementById('uploadBtn');
    const uploadSection = document.getElementById('uploadSection');
    const processingSection = document.getElementById('processingSection');
    const resultsSection = document.getElementById('resultsSection');
    const errorSection = document.getElementById('errorSection');
    const resultsContent = document.getElementById('resultsContent');
    const errorMessage = document.getElementById('errorMessage');

    // Drag & Drop
    dropZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropZone.classList.add('border-blue-500', 'bg-blue-50');
    });

    dropZone.addEventListener('dragleave', () => {
        dropZone.classList.remove('border-blue-500', 'bg-blue-50');
    });

    dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropZone.classList.remove('border-blue-500', 'bg-blue-50');
        const file = e.dataTransfer.files[0];
        handleFileSelect(file);
    });

    fileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        handleFileSelect(file);
    });

    function handleFileSelect(file) {
        if (!file) return;

        const validTypes = ['application/pdf', 'image/jpeg', 'image/png', 'image/jpg'];
        if (!validTypes.includes(file.type)) {
            alert('–ú–æ–ª—è –∏–∑–±–µ—Ä–µ—Ç–µ PDF, JPG –∏–ª–∏ PNG —Ñ–∞–π–ª');
            return;
        }

        if (file.size > 10 * 1024 * 1024) {
            alert('–§–∞–π–ª—ä—Ç –µ —Ç–≤—ä—Ä–¥–µ –≥–æ–ª—è–º (–º–∞–∫—Å 10MB)');
            return;
        }

        selectedFile = file;
        fileNameSpan.textContent = file.name;
        selectedFileDiv.classList.remove('hidden');
    }

    uploadBtn.addEventListener('click', async () => {
        if (!selectedFile) return;

        uploadSection.classList.add('hidden');
        processingSection.classList.remove('hidden');
        errorSection.classList.add('hidden');

        const formData = new FormData();
        formData.append('file', selectedFile);

        try {
            const response = await fetch(`${API_URL}/api/v1/documents/upload`, {
                method: 'POST',
                body: formData
            });

            const data = await response.json();

            if (data.status === 'success' && data.extraction && data.extraction.success) {
                showResults(data);
            } else {
                const errorMsg = (data.extraction && data.extraction.error) 
                    ? data.extraction.error 
                    : '–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞';
                showError(errorMsg);
            }
        } catch (error) {
            showError('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ —Å–≤—ä—Ä–∑–≤–∞–Ω–µ —Å—ä—Å —Å—ä—Ä–≤—ä—Ä–∞: ' + error.message);
        }
    });

    function showResults(data) {
        processingSection.classList.add('hidden');
        resultsSection.classList.remove('hidden');
        resultsData = data;

        const invoice = data.extraction.data;

        resultsContent.innerHTML = `
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <p class="text-sm text-gray-600">–§–∞–∫—Ç—É—Ä–∞ ‚Ññ</p>
                    <p class="text-xl font-bold">${invoice.invoice_number || 'N/A'}</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <p class="text-sm text-gray-600">–î–∞—Ç–∞</p>
                    <p class="text-xl font-bold">${invoice.date || 'N/A'}</p>
                </div>
            </div>

            <div class="bg-blue-50 p-4 rounded-lg">
                <p class="text-sm text-gray-600 font-semibold mb-2">–î–æ—Å—Ç–∞–≤—á–∏–∫</p>
                <p class="font-bold">${invoice.vendor?.name || 'N/A'}</p>
                <p class="text-sm">${invoice.vendor?.address || ''}</p>
                <p class="text-sm">–ï–ò–ö: ${invoice.vendor?.vat_number || 'N/A'}</p>
            </div>

            <div class="bg-green-50 p-4 rounded-lg">
                <p class="text-sm text-gray-600 font-semibold mb-2">–ö–ª–∏–µ–Ω—Ç</p>
                <p class="font-bold">${invoice.client?.name || 'N/A'}</p>
                <p class="text-sm">${invoice.client?.address || ''}</p>
            </div>

            <div class="bg-gray-50 p-4 rounded-lg">
                <p class="text-sm text-gray-600 font-semibold mb-2">–ê—Ä—Ç–∏–∫—É–ª–∏ (${invoice.items?.length || 0})</p>
                <div class="space-y-2 max-h-40 overflow-y-auto">
                    ${invoice.items?.map((item, index) => `
                        <div class="text-sm border-b pb-2">
                            <p class="font-semibold">${index + 1}. ${item.description}</p>
                            <p class="text-gray-600">
                                ${item.quantity} x ${item.unit_price} = ${item.total} ${invoice.currency}
                            </p>
                        </div>
                    `).join('') || '<p class="text-gray-500">–ù—è–º–∞ –∞—Ä—Ç–∏–∫—É–ª–∏</p>'}
                </div>
            </div>

            <div class="bg-yellow-50 p-6 rounded-lg border-2 border-yellow-200">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-sm text-gray-600">–ë–µ–∑ –î–î–°</p>
                        <p class="text-lg">${invoice.totals?.subtotal || 0} ${invoice.currency}</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-600">–î–î–° (${invoice.totals?.vat_rate || 0}%)</p>
                        <p class="text-lg">${invoice.totals?.vat_amount || 0} ${invoice.currency}</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-600 font-semibold">–û–ë–©–û</p>
                        <p class="text-3xl font-bold text-green-600">${invoice.totals?.total || 0} ${invoice.currency}</p>
                    </div>
                </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-lg text-sm text-gray-600">
                <p>‚è±Ô∏è Processing time: ${data.processing_time_seconds}s</p>
                <p>üí∞ API cost: $${data.extraction.cost_usd?.total?.toFixed(4) || 'N/A'}</p>
                <p>ü§ñ Model: ${data.extraction.model}</p>
            </div>
        `;
    }

    function showError(message) {
        processingSection.classList.add('hidden');
        errorSection.classList.remove('hidden');
        errorMessage.textContent = message;
    }

    document.getElementById('newDocBtn').addEventListener('click', reset);
    document.getElementById('retryBtn').addEventListener('click', reset);

    document.getElementById('downloadJsonBtn').addEventListener('click', () => {
        const blob = new Blob([JSON.stringify(resultsData, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `invoice_${resultsData.extraction.data.invoice_number || 'result'}.json`;
        a.click();
    });

    document.getElementById('copyDataBtn').addEventListener('click', () => {
        navigator.clipboard.writeText(JSON.stringify(resultsData.extraction.data, null, 2));
        alert('–î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –∫–æ–ø–∏—Ä–∞–Ω–∏!');
    });

    function reset() {
        selectedFile = null;
        fileInput.value = '';
        selectedFileDiv.classList.add('hidden');
        uploadSection.classList.remove('hidden');
        processingSection.classList.add('hidden');
        resultsSection.classList.add('hidden');
        errorSection.classList.add('hidden');
    }
</script>
<script>
/* ---------------------------------------------------------
   –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –ª–æ–∫–∞–ª–Ω–∏ Arimo —à—Ä–∏—Ñ—Ç–æ–≤–µ (Arial-compatible)
--------------------------------------------------------- */

// –ü—Ä–µ–≤—Ä—ä—â–∞ .ttf —Ñ–∞–π–ª ‚Üí Base64 ‚Üí –≥–æ—Ç–æ–≤ –∑–∞ jsPDF
async function loadFont(url) {
    const response = await fetch(url);
    const buffer = await response.arrayBuffer();
    let binary = "";
    const bytes = new Uint8Array(buffer);

    for (let i = 0; i < bytes.byteLength; i++) {
        binary += String.fromCharCode(bytes[i]);
    }

    return btoa(binary);
}

// –†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞ —Ç—Ä–∏—Ç–µ —à—Ä–∏—Ñ—Ç–∞ –≤ jsPDF
async function registerFonts() {
    const regular = await loadFont("fonts/Arimo-Regular.ttf");
    const bold = await loadFont("fonts/Arimo-Bold.ttf");
    const italic = await loadFont("fonts/Arimo-Italic.ttf");

    // jsPDF 1.5.3 API
    jsPDF.API.addFileToVFS("Arimo-Regular.ttf", regular);
    jsPDF.API.addFont("Arimo-Regular.ttf", "Arimo", "normal");

    jsPDF.API.addFileToVFS("Arimo-Bold.ttf", bold);
    jsPDF.API.addFont("Arimo-Bold.ttf", "Arimo", "bold");

    jsPDF.API.addFileToVFS("Arimo-Italic.ttf", italic);
    jsPDF.API.addFont("Arimo-Italic.ttf", "Arimo", "italic");
}

<script>
/* ---------------------------------------------------------
   –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –ª–æ–∫–∞–ª–Ω–∏ Arimo —à—Ä–∏—Ñ—Ç–æ–≤–µ (Regular, Bold, Italic)
--------------------------------------------------------- */

async function loadFont(url) {
    const response = await fetch(url);
    const buffer = await response.arrayBuffer();
    let binary = "";
    const bytes = new Uint8Array(buffer);

    for (let i = 0; i < bytes.byteLength; i++) {
        binary += String.fromCharCode(bytes[i]);
    }

    return btoa(binary);
}

async function registerFonts() {
    const regular = await loadFont("fonts/Arimo-Regular.ttf");
    const bold = await loadFont("fonts/Arimo-Bold.ttf");
    const italic = await loadFont("fonts/Arimo-Italic.ttf");

    jsPDF.API.addFileToVFS("Arimo-Regular.ttf", regular);
    jsPDF.API.addFont("Arimo-Regular.ttf", "Arimo", "normal");

    jsPDF.API.addFileToVFS("Arimo-Bold.ttf", bold);
    jsPDF.API.addFont("Arimo-Bold.ttf", "Arimo", "bold");

    jsPDF.API.addFileToVFS("Arimo-Italic.ttf", italic);
    jsPDF.API.addFont("Arimo-Italic.ttf", "Arimo", "italic");
}

/* ---------------------------------------------------------
   üìÑ EXPORT PDF ‚Äî –û–§–ò–¶–ò–ê–õ–ù–ê –§–ê–ö–¢–£–†–ê
--------------------------------------------------------- */

document.getElementById("exportPdfBtn").addEventListener("click", async () => {
    if (!resultsData) {
        alert("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ PDF.");
        return;
    }

    await registerFonts();

    const invoice = resultsData.extraction.data;
    const doc = new jsPDF();

    /* –ó–∞–≥–ª–∞–≤–∏–µ */
    doc.setFont("Arimo", "bold");
    doc.setFontSize(22);
    doc.text("–§–∞–∫—Ç—É—Ä–∞", 14, 20);

    /* –û—Å–Ω–æ–≤–Ω–∏ –¥–∞–Ω–Ω–∏ */
    doc.setFont("Arimo", "normal");
    doc.setFontSize(12);

    doc.text("–§–∞–∫—Ç—É—Ä–∞ ‚Ññ: " + (invoice.invoice_number || "N/A"), 14, 35);
    doc.text("–î–∞—Ç–∞: " + (invoice.date || "N/A"), 14, 42);

    /* –î–æ—Å—Ç–∞–≤—á–∏–∫ */
    doc.setFont("Arimo", "bold");
    doc.text("–î–æ—Å—Ç–∞–≤—á–∏–∫:", 14, 55);

    doc.setFont("Arimo", "normal");
    doc.text(invoice.vendor?.name || "", 14, 62);
    doc.text(invoice.vendor?.address || "", 14, 68);
    doc.text("–ï–ò–ö: " + (invoice.vendor?.vat_number || ""), 14, 74);

    /* –ö–ª–∏–µ–Ω—Ç */
    doc.setFont("Arimo", "bold");
    doc.text("–ö–ª–∏–µ–Ω—Ç:", 110, 55);

    doc.setFont("Arimo", "normal");
    doc.text(invoice.client?.name || "", 110, 62);
    doc.text(invoice.client?.address || "", 110, 68);
    doc.text("–ï–ò–ö: " + (invoice.client?.vat_number || ""), 110, 74);

    /* –¢–∞–±–ª–∏—Ü–∞ —Å –∞—Ä—Ç–∏–∫—É–ª–∏ */
    const items = (invoice.items || []).map((item, index) => [
        index + 1,
        item.description || "",
        item.quantity || "",
        item.unit_price || "",
        item.total || ""
    ]);

    doc.autoTable({
        startY: 90,
        head: [["‚Ññ", "–û–ø–∏—Å–∞–Ω–∏–µ", "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ", "–ï–¥. —Ü–µ–Ω–∞", "–û–±—â–æ"]],
        body: items,
        styles: { font: "Arimo", fontSize: 10 },
        headStyles: { fillColor: [66, 66, 66], textColor: 255, fontStyle: "bold" }
    });

    /* –û–±–æ–±—â–µ–Ω–∏–µ */
    let finalY = doc.autoTable.previous.finalY + 10;

    doc.setFont("Arimo", "bold");
    doc.text("–û–±–æ–±—â–µ–Ω–∏–µ:", 14, finalY);

    doc.setFont("Arimo", "normal");
    doc.text("–ë–µ–∑ –î–î–°: " + invoice.totals?.subtotal + " " + invoice.currency, 14, finalY + 8);
    doc.text("–î–î–° (" + invoice.totals?.vat_rate + "%): " + invoice.totals?.vat_amount + " " + invoice.currency, 14, finalY + 16);
    doc.text("–û–±—â–æ: " + invoice.totals?.total + " " + invoice.currency, 14, finalY + 24);

    /* Footer */
    doc.setFont("Arimo", "italic");
    doc.setFontSize(10);
    doc.setTextColor(120);
    doc.text("–î–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ –æ–±—Ä–∞–±–æ—Ç–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç hoseto.cloud", 14, 285);

    doc.save(`faktura_${invoice.invoice_number || "document"}.pdf`);
});

/* ---------------------------------------------------------
   üìä EXPORT EXCEL ‚Äî –ü–™–õ–ï–ù –§–û–†–ú–ê–¢
--------------------------------------------------------- */

document.getElementById("exportExcelBtn").addEventListener("click", () => {
    if (!resultsData) {
        alert("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ Excel.");
        return;
    }

    const invoice = resultsData.extraction.data;
    const sheet = [];

    sheet.push(["–§–∞–∫—Ç—É—Ä–∞"]);
    sheet.push([]);
    sheet.push(["–§–∞–∫—Ç—É—Ä–∞ ‚Ññ", invoice.invoice_number || ""]);
    sheet.push(["–î–∞—Ç–∞", invoice.date || ""]);
    sheet.push(["–í–∞–ª—É—Ç–∞", invoice.currency || ""]);
    sheet.push([]);

    sheet.push(["–î–æ—Å—Ç–∞–≤—á–∏–∫"]);
    sheet.push(["–ò–º–µ", invoice.vendor?.name || ""]);
    sheet.push(["–ê–¥—Ä–µ—Å", invoice.vendor?.address || ""]);
    sheet.push(["–ï–ò–ö", invoice.vendor?.vat_number || ""]);
    sheet.push([]);

    sheet.push(["–ö–ª–∏–µ–Ω—Ç"]);
    sheet.push(["–ò–º–µ", invoice.client?.name || ""]);
    sheet.push(["–ê–¥—Ä–µ—Å", invoice.client?.address || ""]);
    sheet.push(["–ï–ò–ö", invoice.client?.vat_number || ""]);
    sheet.push([]);

    sheet.push(["–ê—Ä—Ç–∏–∫—É–ª–∏"]);
    sheet.push(["‚Ññ", "–û–ø–∏—Å–∞–Ω–∏–µ", "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ", "–ï–¥. —Ü–µ–Ω–∞", "–û–±—â–æ"]);

    (invoice.items || []).forEach((item, index) => {
        sheet.push([
            index + 1,
            item.description || "",
            item.quantity || "",
            item.unit_price || "",
            item.total || ""
        ]);
    });

    sheet.push([]);
    sheet.push(["–û–±–æ–±—â–µ–Ω–∏–µ"]);
    sheet.push(["–ë–µ–∑ –î–î–°", invoice.totals?.subtotal || ""]);
    sheet.push(["–î–î–°", invoice.totals?.vat_amount || ""]);
    sheet.push(["–û–±—â–æ", invoice.totals?.total || ""]);

    const worksheet = XLSX.utils.aoa_to_sheet(sheet);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, "Invoice");

    XLSX.writeFile(workbook, `faktura_${invoice.invoice_number || "document"}.xlsx`);
});
</script>
</body>
</html>
